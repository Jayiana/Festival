@page "/resetpassword"

<div class="auth-box text-center">
    <div class="titlu">
        <img src="/SiteImages/OtherPages/titlu.png" alt="ShowTime">
    </div>

    <div class="box">
        <EditForm Model="resetModel" OnValidSubmit="HandleReset" FormName="ResetForm">
            <h1>🔒 Reset Your Password</h1>

            @if (resetFailed)
            {
                <p class="error">❌ Passwords must match and fields must not be empty.</p>
            }
            @if (resetSuccess)
            {
                <p class="success">✅ Password reset successfully!</p>
            }

            <div class="inputBox">
                <InputText @bind-Value="resetModel.Email" id="emailField" required />
                <span>Email</span>
                <i class="fa fa-envelope"></i>
            </div>

            <div class="inputBox">
                <InputText @bind-Value="resetModel.NewPassword" type="password" id="newPasswordField" required />
                <span>New Password</span>
                <i class="fa fa-lock"></i>
            </div>

            <div class="inputBox">
                <InputText @bind-Value="resetModel.ConfirmPassword" type="password" id="confirmPasswordField" required />
                <span>Confirm Password</span>
                <i class="fa fa-lock"></i>
            </div>

            <button type="submit">🔁 Reset</button>

            <p class="or">Go back to <a href="/login">Log In</a></p>

            <audio autoplay loop id="audio">
                <source src="/SiteMedia/BlackPantherLoginTheme.mp3" type="audio/mpeg">
            </audio>

            <div class="sound-toggle">
                <label for="mutesound">🔊 Enable Sound</label>
                <input type="checkbox" id="mutesound" checked onclick="EnableAudio()" />
            </div>
        </EditForm>
    </div>
</div>

@code {
    private ResetModel resetModel = new();
    private bool resetFailed;
    private bool resetSuccess;

    private async Task HandleReset()
    {
        resetFailed = false;
        resetSuccess = false;

        if (string.IsNullOrWhiteSpace(resetModel.Email) ||
            resetModel.NewPassword != resetModel.ConfirmPassword)
        {
            resetFailed = true;
            return;
        }

        resetSuccess = true;

     
    }

    public class ResetModel
    {
        public string Email { get; set; } = string.Empty;
        public string NewPassword { get; set; } = string.Empty;
        public string ConfirmPassword { get; set; } = string.Empty;
    }
}
